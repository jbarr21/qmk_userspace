#include QMK_KEYBOARD_H

#ifdef OLED_ENABLE
static void render_status(void) {
    // Host Keyboard Layer Status
    oled_write_P(PSTR("\nLayer: "), false);

    switch (get_highest_layer(layer_state)) {
        case DEF: oled_write_P(PSTR("DEFAULT\n"), false); break;
        case SYM: oled_write_P(PSTR("SYMBOL\n"), false); break;
        case NAV: oled_write_P(PSTR("NAVIGATION\n"), false); break;
        case NUM: oled_write_P(PSTR("NUMBER\n"), false); break;
        case FUN: oled_write_P(PSTR("FUNCTION\n"), false); break;
        case IDE: oled_write_P(PSTR("IDE\n"), false); break;
        case MOU: oled_write_P(PSTR("MOUSE\n"), false); break;
        case MED: oled_write_P(PSTR("MEDIA\n"), false); break;
        default: oled_write_ln_P(PSTR("N/A"), false);
    }

    // Host Keyboard LED Status
    led_t led_state = host_keyboard_led_state();
    oled_write_P(led_state.num_lock ? PSTR("NUM ") : PSTR("    "), false);
    oled_write_P(led_state.caps_lock ? PSTR("CAP ") : PSTR("    "), false);
    oled_write_P(led_state.scroll_lock ? PSTR("SCR ") : PSTR("    "), false);
}

static void render_logo(void) {
  static const char PROGMEM logo[] = { 
    // plain bytes, Vertical 1 bit per pixel on https://javl.github.io/image2cpp/
    // 'sweeeeep_logo_broom_5e', 128x32px
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0x70, 0x38, 0x1c, 0x0e, 0x07, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0xc0, 
    0xe0, 0x70, 0x38, 0x1c, 0x0e, 0x07, 0x03, 0x01, 0x00, 0x00, 0x00, 0x70, 0xfc, 0xfc, 0xce, 0x86, 
    0x86, 0x86, 0x86, 0x0e, 0x0e, 0x0e, 0x00, 0x00, 0x00, 0xe0, 0xe0, 0x80, 0x00, 0x00, 0x80, 0xe0, 
    0xe0, 0xc0, 0x00, 0x00, 0x00, 0xe0, 0xe0, 0x20, 0x00, 0x80, 0xc0, 0xe0, 0xe0, 0x60, 0x60, 0x60, 
    0xe0, 0xc0, 0x80, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0xe0, 0x60, 0x60, 0x60, 0xe0, 0xc0, 0x80, 0x00, 
    0x00, 0x80, 0xc0, 0xe0, 0xe0, 0x60, 0x60, 0x60, 0xe0, 0xc0, 0x80, 0x00, 0x00, 0x80, 0xc0, 0xe0, 
    0xe0, 0x60, 0x60, 0x60, 0xe0, 0xc0, 0x80, 0x00, 0x00, 0x80, 0xc0, 0xe0, 0xe0, 0x60, 0x60, 0x60, 
    0xe0, 0xc0, 0x80, 0x00, 0x00, 0x00, 0xe0, 0xe0, 0xc0, 0x60, 0x60, 0x60, 0xe0, 0xe0, 0xc0, 0x00, 
    0x00, 0xe0, 0xf0, 0xf0, 0xf8, 0xfc, 0xfe, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x3f, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x70, 0xe1, 0xe1, 0xc1, 
    0xc3, 0xc3, 0xe3, 0xe3, 0x7f, 0x7e, 0x1c, 0x00, 0x00, 0x01, 0x0f, 0xff, 0xf8, 0xfc, 0x3f, 0x03, 
    0x01, 0x0f, 0x7e, 0xf0, 0xfe, 0x3f, 0x03, 0x00, 0x00, 0x3f, 0x7f, 0xf6, 0xe6, 0xc6, 0xc6, 0xc6, 
    0xc6, 0xe7, 0x67, 0x00, 0x00, 0x3f, 0x7f, 0xf6, 0xe6, 0xc6, 0xc6, 0xc6, 0xc6, 0xe7, 0x67, 0x00, 
    0x00, 0x3f, 0x7f, 0xf6, 0xe6, 0xc6, 0xc6, 0xc6, 0xc6, 0xe7, 0x67, 0x00, 0x00, 0x3f, 0x7f, 0xf6, 
    0xe6, 0xc6, 0xc6, 0xc6, 0xc6, 0xe7, 0x67, 0x00, 0x00, 0x3f, 0x7f, 0xf6, 0xe6, 0xc6, 0xc6, 0xc6, 
    0xc6, 0xe7, 0x67, 0x00, 0x00, 0x00, 0xff, 0xff, 0xe0, 0xc0, 0xc0, 0xe0, 0xe0, 0x7f, 0x3f, 0x0e, 
    0x00, 0x00, 0x01, 0x07, 0x0f, 0x0f, 0x1f, 0x3f, 0x3f, 0x3f, 0x1f, 0x07, 0x03, 0x01, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  };

  oled_write_raw_P(logo, sizeof(logo));
}

bool oled_task_user(void) {
    if (is_keyboard_master()) {
        render_status();
    } else {
        render_logo();
    }
    return false;
}

oled_rotation_t oled_init_user(oled_rotation_t rotation) {
    if (!is_keyboard_master()) {
        return OLED_ROTATION_180;  // flips the display 180 degrees if offhand
    }

    return rotation;
}
#endif
